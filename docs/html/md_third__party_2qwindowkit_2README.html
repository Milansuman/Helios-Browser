<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project Web: QWindowKit</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Project Web<span id="projectnumber">&#160;0.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">QWindowKit</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md82"></a> Cross-platform window customization framework for Qt Widgets and Qt Quick.</p>
<p>This project inherited most of <a href="https://github.com/wangwenx190/framelesshelper">wangwenx190 FramelessHelper</a> implementation, with a complete refactoring and upgrading of the architecture.</p>
<p>Feature requests are welcome.</p>
<h1><a class="anchor" id="autotoc_md83"></a>
Join with Us :triangular_flag_on_post:</h1>
<p>You can join our <a href="https://discord.gg/grrM4Tmesy">Discord channel</a>. You can share your findings, thoughts and ideas on improving / implementing FramelessHelper functionalities on more platforms and apps!</p>
<h1><a class="anchor" id="autotoc_md84"></a>
Supported Platforms</h1>
<ul>
<li>Microsoft Windows</li>
<li>Apple macOS (11+)</li>
<li>GNU/Linux</li>
</ul>
<h1><a class="anchor" id="autotoc_md85"></a>
Features</h1>
<ul>
<li>Full support of Windows 11 Snap Layout</li>
<li>Better workaround to handle Windows 10 top border issue</li>
<li>Support Mac system buttons geometry customization</li>
<li>Simpler APIs, more detailed documentations and comments</li>
</ul>
<h1><a class="anchor" id="autotoc_md86"></a>
Gallery</h1>
<h2><a class="anchor" id="autotoc_md87"></a>
Windows 11 (With Snap Layout)</h2>
<p><img src="./docs/images/win11.png" alt="image" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md88"></a>
Windows 10 (And 7, Vista)</h2>
<p><img src="./docs/images/win10.png" alt="image" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md89"></a>
macOS &amp; Linux</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">macOS   </th><th class="markdownTableHeadCenter">Linux (Ubuntu 20.04)    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><img src="./docs/images/mac.png" alt="image" class="inline"/>   </td><td class="markdownTableBodyCenter"><img src="./docs/images/linux.png" alt="image" class="inline"/>   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md90"></a>
Requirements</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Component   </th><th class="markdownTableHeadCenter">Requirement   </th><th class="markdownTableHeadCenter">Details    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Qt   </td><td class="markdownTableBodyCenter">&gt;=5.12   </td><td class="markdownTableBodyCenter">Core, Gui, Widgets, Quick    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Compiler   </td><td class="markdownTableBodyCenter">&gt;=C++17   </td><td class="markdownTableBodyCenter">MSVC 2019, GCC, Clang    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CMake   </td><td class="markdownTableBodyCenter">&gt;=3.19   </td><td class="markdownTableBodyCenter">&gt;=3.20 is recommended   </td></tr>
</table>
<p>Please read Vulnerabilities carefully to acquire detailed requirements.</p>
<h2><a class="anchor" id="autotoc_md91"></a>
Tested Compilers</h2>
<ul>
<li>Windows<ul>
<li>MSVC: 2019, 2022</li>
<li>MinGW (GCC): 13.2.0</li>
</ul>
</li>
<li>macOS<ul>
<li>Clang 14.0.3</li>
</ul>
</li>
<li>Ubuntu<ul>
<li>GCC: 9.4.0</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md92"></a>
Dependencies</h1>
<ul>
<li>Qt 5.12 or higher</li>
<li><a href="https://github.com/stdware/qmsetup">qmsetup</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md93"></a>
Integrate</h1>
<h2><a class="anchor" id="autotoc_md94"></a>
Build &amp; Install</h2>
<div class="fragment"><div class="line">git clone --recursive https://github.com/stdware/qwindowkit</div>
<div class="line">cd qwindowkit</div>
<div class="line"> </div>
<div class="line">cmake -B build -S . \</div>
<div class="line">  -Dqmsetup_DIR=&lt;dir&gt; \ # Optional</div>
<div class="line">  -DCMAKE_INSTALL_PREFIX=/path/install \</div>
<div class="line">  -G &quot;Ninja Multi-Config&quot;</div>
<div class="line"> </div>
<div class="line">cmake --build build --target install --config Debug --parallel</div>
<div class="line">cmake --build build --target install/strip --config Release --parallel</div>
</div><!-- fragment --><p> You can also include this directory as a subproject if you choose CMake as your build system.</p>
<p>For other build systems, you need to install with CMake first and include the corresponding configuration files in your project.</p>
<h2><a class="anchor" id="autotoc_md95"></a>
Import</h2>
<h3><a class="anchor" id="autotoc_md96"></a>
CMake Project</h3>
<div class="fragment"><div class="line">cmake -B build -DQWindowKit_DIR=/path/install/lib/cmake/QWindowKit</div>
</div><!-- fragment --><div class="fragment"><div class="line">find_package(QWindowKit COMPONENTS Core Widgets Quick REQUIRED)</div>
<div class="line">target_link_libraries(widgets_app PUBLIC QWindowKit::Widgets)</div>
<div class="line">target_link_libraries(quick_app PUBLIC QWindowKit::Quick)</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md97"></a>
QMake Project</h3>
<div class="fragment"><div class="line"># WidgetsApp.pro</div>
<div class="line">include(&quot;/path/install/share/QWindowKit/qmake/QWKWidgets.pri&quot;)</div>
<div class="line"> </div>
<div class="line"># QuickApp.pro</div>
<div class="line">include(&quot;/path/install/share/QWindowKit/qmake/QWKQuick.pri&quot;)</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md98"></a>
Visual Studio Project</h3>
<p>See <a class="el" href="md_third__party_2qwindowkit_2docs_2visual-studio-guide.html">Visual Studio Guide</a> for detailed usages.</p>
<h1><a class="anchor" id="autotoc_md99"></a>
Quick Start</h1>
<h2><a class="anchor" id="autotoc_md100"></a>
Qt Widgets Application</h2>
<h3><a class="anchor" id="autotoc_md101"></a>
Initialization</h3>
<p>The following initialization should be done before any widget constructs.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;QtWidgets/QApplication&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    QGuiApplication::setAttribute(Qt::AA_DontCreateNativeWidgetSiblings)</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md102"></a>
Setup Window Agent</h3>
<p>First, setup <code>WidgetWindowAgent</code> for your top <code>QWidget</code> instance. (Each window needs its own agent.)</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="preprocessor">#include &lt;QWKWidgets/widgetwindowagent.h&gt;</span></div>
<div class="line"> </div>
<div class="line">MyWidget::MyWidget(QWidget *parent) {</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">    <span class="keyword">auto</span> agent = <span class="keyword">new</span> <a class="code hl_class" href="classQWK_1_1WidgetWindowAgent.html">QWK::WidgetWindowAgent</a>(<span class="keyword">this</span>);</div>
<div class="line">    agent-&gt;setup(<span class="keyword">this</span>);</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassQWK_1_1WidgetWindowAgent_html"><div class="ttname"><a href="classQWK_1_1WidgetWindowAgent.html">QWK::WidgetWindowAgent</a></div><div class="ttdoc">WindowAgentBase is the window agent for QtWidgets.</div><div class="ttdef"><b>Definition</b> widgetwindowagent.h:17</div></div>
</div><!-- fragment --><p>If you don't want to derive a new widget class or change the constructor, you can initialize the agent after the window constructs.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line"><span class="keyword">auto</span> w = <span class="keyword">new</span> MyWidget();</div>
<div class="line"><span class="keyword">auto</span> agent = <span class="keyword">new</span> <a class="code hl_class" href="classQWK_1_1WidgetWindowAgent.html">QWK::WidgetWindowAgent</a>(w);</div>
<div class="line">agent-&gt;setup(w);</div>
</div><!-- fragment --><p>You should call <code><a class="el" href="classQWK_1_1WidgetWindowAgent.html#aaf4c32239222367230bd6c1baa0ff3ae">QWK::WidgetWindowAgent::setup()</a></code> as early as possible, especially when you need to set the size constrains. QWindowKit will change some Qt internal data which will affect how Qt calculates the window size, and thus you need to let QWindowKit initialize at the very beginning.</p>
<h3><a class="anchor" id="autotoc_md103"></a>
Construct Title bar</h3>
<p>Then, construct your title bar widget, without which the window lacks the basic interaction feature, and it's better to put it into the window's layout.</p>
<p>You can use the <a href="examples/shared/widgetframe/windowbar.h"><code>WindowBar</code></a> provided by <code>WidgetFrame</code> in the examples as the container of your title bar components.</p>
<p>Let <code>WidgetWindowAgent</code> know which widget the title bar is.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line">agent-&gt;setTitleBar(myTitleBar);</div>
</div><!-- fragment --><p>Next, set system button hints to let <code>WidgetWindowAgent</code> know the role of the child widgets, which is important for the Snap Layout to work.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line">agent-&gt;setSystemButton(QWK::WindowAgentBase::WindowIcon, myTitleBar-&gt;iconButton());</div>
<div class="line">agent-&gt;setSystemButton(QWK::WindowAgentBase::Minimize, myTitleBar-&gt;minButton());</div>
<div class="line">agent-&gt;setSystemButton(QWK::WindowAgentBase::Maximize, myTitleBar-&gt;maxButton());</div>
<div class="line">agent-&gt;setSystemButton(QWK::WindowAgentBase::Close, myTitleBar-&gt;closeButton());</div>
</div><!-- fragment --><p>Doing this does not mean that these buttons' click events are automatically associated with window actions, you still need to manually connect the signals and slots to emulate the native window behaviors.</p>
<p>On macOS, this step can be skipped because it is better to use the buttons provided by the system.</p>
<p>Last but not least, set hit-test visible hint to let <code>WidgetWindowAgent</code> know which widgets are willing to receive mouse events.</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line">agent-&gt;setHitTestVisible(myTitleBar-&gt;menuBar(), <span class="keyword">true</span>);</div>
</div><!-- fragment --><p>The rest region within the title bar will be regarded as the draggable area for the user to move the window, and thus any QWidgets inside it will not receive any user interaction events such as mouse events/focus events/etc anymore, but you can still send/post such events to these widgets manually, either through Qt API or system API.</p>
<ul>
<li>If you want to disable window maximization, you can remove the <code>Qt::WindowMaximizeButtonHint</code> flag from the window.</li>
</ul>
<h2><a class="anchor" id="autotoc_md104"></a>
Qt Quick Application</h2>
<h3><a class="anchor" id="autotoc_md105"></a>
Initialization</h3>
<p>Make sure you have registered <code>QWindowKit</code> into QtQuick:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;QWKQuick/qwkquickglobal.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">    QQmlApplicationEngine engine;</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">    QWK::registerTypes(&amp;engine);</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md106"></a>
Setup Window Components</h3>
<p>Then you can use <code>QWindowKit</code> data types and classes by importing its URI:</p>
<div class="fragment"><div class="line">import QtQuick 2.15</div>
<div class="line">import QtQuick.Window 2.15</div>
<div class="line">import QWindowKit 1.0</div>
<div class="line"> </div>
<div class="line">Window {</div>
<div class="line">    id: window</div>
<div class="line">    visible: false // We hide it first, so we can move the window to our desired position silently.</div>
<div class="line">    Component.onCompleted: {</div>
<div class="line">        windowAgent.setup(window)</div>
<div class="line">        window.visible = true</div>
<div class="line">    }</div>
<div class="line">    WindowAgent {</div>
<div class="line">        id: windowAgent</div>
<div class="line">        // ...</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>You can omit the version number or use "auto" instead of "1.0" for the module URI if you are using Qt6.</p>
<p>As we just mentioned above, if you are going to set the size constrains, please do it after <code>windowAgent.setup()</code> is called.</p>
<h2><a class="anchor" id="autotoc_md107"></a>
Learn More</h2>
<p>See [examples](examples) for more demo use cases. The examples have no High DPI support.</p>
<ul>
<li>QWindowKit Internals [TODO]</li>
<li><a class="el" href="md_third__party_2qwindowkit_2docs_2framelesshelper-related.html">FramelessHelper Related</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md108"></a>
Vulnerabilities</h2>
<h3><a class="anchor" id="autotoc_md109"></a>
Qt Version</h3>
<ul>
<li>To achieve better frameless functionality, QWindowKit depends heavily on Qt's internal implementation. However, there are many differences in different versions of Qt, and earlier versions of Qt5 and Qt6 have many bugs which make it extremely difficult for QWindowKit to workaround without changing the Qt source code.</li>
<li>And also due to limited manpower, although QWindowKit can be successfully compiled on Qt 5.12 or later, it can hardly work perfectly on all Qt versions.</li>
<li>Therefore, the following Qt version ranges are recommended, if there are any exceptions with QWindowKit in your application, make sure the Qt version you use is in the ranges before raising the issue.<ul>
<li>Qt 5: 5.15.2 or higher</li>
<li>Qt 6: 6.6.2 or higher (the newer, the better)</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md110"></a>
Hot Switch</h3>
<ul>
<li>Once you have made the window frameless, it will not be able to switch back to the system frame again unless you destroy your window and recreate it with different settings.</li>
</ul>
<h3><a class="anchor" id="autotoc_md111"></a>
Native Child Widget</h3>
<ul>
<li>There <b>must not</b> be any internal child widget with <code>Qt::WA_NativeWindow</code> property enabled, otherwise the native features and display may be abnormal. Therefore, do not set any widget that has called <code>QWidget::winId()</code> or <code>QWidget::setAttribute(Qt::WA_NativeWindow)</code> as a descendant of a frameless window.<ul>
<li>If you really need to move widgets between different windows, make sure that the widget is not a top-level window and wrap it with a frameless container window.</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="autotoc_md112"></a>
Size Constrains</h3>
<ul>
<li>If you want to disable window resizing, you can set a fixed size, which is officially supported by QWindowKit. If you use other special means to achieve this, <a class="el" href="namespaceQWK.html" title="QWindowKit namespace.">QWK</a> doesn't guarantee everything can still be fully functional.</li>
<li>If you set a maximized width or height, the window should not be maximized because you cannot get the correct window size through Qt APIs. You may workaround this by using system APIs such as <code>GetWindowRect</code> or <code>GetClientRect</code>. The root cause lies deep in Qt QPA implementations and currently we don't know how to fix it without modifying Qt itself.</li>
</ul>
<h3><a class="anchor" id="autotoc_md113"></a>
Windows 10</h3>
<ul>
<li>Due to the inherent defects in the Windows 10 window system, the top border will disappear when the system title bar is removed. We have filtered Qt's event and perfectly reshown the system top border, thanks to the implementation of Windows Terminal for our reference. However, this workaround only works with QtWidgets and QtQuick (<b>only when rendering through D3D</b>) applications.</li>
<li>In QtQuick applications that use OpenGL or other rendering backends, we use Qt's painting system to emulate this border. But since Windows 10 system border is translucent, the difference from the system border is more noticeable in a dark background.</li>
</ul>
<h1><a class="anchor" id="autotoc_md114"></a>
TODO</h1>
<ul>
<li>Fix mouse cursor mapping issues</li>
<li>More documentations</li>
<li>When do we support Linux native features?</li>
</ul>
<h1><a class="anchor" id="autotoc_md115"></a>
Special Thanks</h1>
<ul>
<li><a href="https://github.com/Maplespe">Maplespe</a></li>
<li><a href="https://github.com/zhiyiYo">zhiyiYo</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md116"></a>
License</h1>
<p>QWindowKit is licensed under the <a href="./LICENSE">Apache 2.0 License</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
